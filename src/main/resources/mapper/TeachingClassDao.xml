<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.server.edu.election.dao.TeachingClassDao">
  <resultMap id="BaseResultMap" type="com.server.edu.election.entity.TeachingClass">
    <id column="ID_" jdbcType="BIGINT" property="id" />
    <result column="TASK_ID_" jdbcType="BIGINT" property="taskId" />
    <result column="CODE_" jdbcType="VARCHAR" property="code" />
    <result column="IS_MEDIA_" jdbcType="INTEGER" property="isMedia" />
    <result column="ROOM_TYPE_" jdbcType="VARCHAR" property="roomType" />
    <result column="TEACHING_LANGUAGE_" jdbcType="VARCHAR" property="teachingLanguage" />
    <result column="COURSE_LABEL_ID_" jdbcType="BIGINT" property="courseLabelId" />
    <result column="ASSESSMENT_MODE_" jdbcType="VARCHAR" property="assessmentMode" />
    <result column="PERIOD_" jdbcType="DOUBLE" property="period" />
    <result column="ARRANGE_MODE_" jdbcType="VARCHAR" property="arrangeMode" />
    <result column="WEEK_HOUR_" jdbcType="DOUBLE" property="weekHour" />
    <result column="CLASS_HOUR_" jdbcType="DOUBLE" property="classHour" />
    <result column="MEDIA_HOUR_" jdbcType="DOUBLE" property="mediaHour" />
    <result column="START_WEEK_" jdbcType="INTEGER" property="startWeek" />
    <result column="END_WEEK_" jdbcType="INTEGER" property="endWeek" />
    <result column="TOTAL_WEEK_" jdbcType="INTEGER" property="totalWeek" />
    <result column="CAMPUS_" jdbcType="VARCHAR" property="campus" />
    <result column="CLASS_TYPE_" jdbcType="VARCHAR" property="classType" />
    <result column="NUMBER_" jdbcType="INTEGER" property="number" />
    <result column="ELC_NUMBER_" jdbcType="INTEGER" property="elcNumber" />
    <result column="PRE_ARRANGE_FLAG_" jdbcType="INTEGER" property="preArrangeFlag" />
    <result column="MAN_ARRANGE_FLAG_" jdbcType="INTEGER" property="manArrangeFlag" />
    <result column="DEPLOY_FLAG_" jdbcType="INTEGER" property="deployFlag" />
    <result column="REMARK_" jdbcType="VARCHAR" property="remark" />
    <result column="CREATED_AT_" jdbcType="TIMESTAMP" property="createdAt" />
    <result column="UPDATED_AT_" jdbcType="TIMESTAMP" property="updatedAt" />
  </resultMap>
  
  <resultMap type="com.server.edu.election.vo.TeachingClassVo" id="TeachingClassVoMap" extends="BaseResultMap">
  	<result column="COURSE_NAME_" jdbcType="VARCHAR" property="courseName" />
  	<result column="CAMPUS_" jdbcType="VARCHAR" property="campus" />
  </resultMap>

  <select id="listPage" parameterType="com.server.edu.election.query.ElcResultQuery" resultMap="TeachingClassVoMap">
    select t1.*, t2.CAMPUS_,  t3.COURSE_NAME_ from 
	teaching_class_t t1 
	join teaching_task_t t2 ON t2.ID_ = t1.TASK_ID_
	join course_open_t t3 ON t3.ID_ = t2.COURSE_OPEN_ID_
    <where>
      t3.CALENDAR_ID_ = #{calendarId}
      <if test="@com.server.edu.util.MybatisUtil@isNotEmpty(teachingClassCode)">
        and t1.CODE_ = #{teachingClassCode,jdbcType=VARCHAR}
      </if>
      <if test="@com.server.edu.util.MybatisUtil@isNotEmpty(manArrangeFlag)">
        and t1.MAN_ARRANGE_FLAG_ = #{manArrangeFlag}
      </if>
      <if test="@com.server.edu.util.MybatisUtil@isNotEmpty(courseCode)">
        and t3.COURSE_CODE_ = #{courseCode,jdbcType=VARCHAR}
      </if>
      <if test="@com.server.edu.util.MybatisUtil@isNotEmpty(courseName)">
        and t3.COURSE_NAME_ = #{courseName,jdbcType=VARCHAR}
      </if>
      <if test="@com.server.edu.util.MybatisUtil@isNotEmpty(campus)">
        and t2.CAMPUS_ = #{campus,jdbcType=VARCHAR}
      </if>
    </where>
  </select>

</mapper>