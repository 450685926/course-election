<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.server.edu.election.dao.ElcAffinityCoursesDao">
  <resultMap id="BaseResultMap" type="com.server.edu.election.entity.ElcAffinityCourses">
    <!--
      WARNING - @mbg.generated
    -->
    <id column="ID_" jdbcType="BIGINT" property="id" />
    <result column="COURSE_CODE_" jdbcType="VARCHAR" property="courseCode" />
  </resultMap>
  <select id="selectElcAffinityCourses" parameterType="com.server.edu.election.dto.ElcAffinityCoursesDto" resultType="com.server.edu.election.vo.ElcAffinityCoursesVo">
		   SELECT
		    DISTINCT
			t2.COURSE_CODE_ courseCode,
			t2.COURSE_NAME_ courseName,
			t2.COURSE_NAME_EN_ courseNameEn,
			t2.TRAINING_LEVEL_ trainingLevel,
			t2.CREDITS_ credits
		FROM
			elc_affinity_courses_t t1
		JOIN (
			SELECT
				COURSE_CODE_,
				COURSE_NAME_,
				COURSE_NAME_EN_,
				TRAINING_LEVEL_,
				CREDITS_
			FROM
				course_open_t
			WHERE
				IS_OPEN_ = 1
		) t2 ON t1.COURSE_CODE_ = t2.COURSE_CODE_
		<where>
		    <if test="@com.server.edu.util.MybatisUtil@isNotEmpty(courseCode)">
		        and t2.COURSE_CODE_ like concat('%',#{courseCode},'%')
		    </if>
		    <if test="@com.server.edu.util.MybatisUtil@isNotEmpty(courseName)">
		        and t2.COURSE_NAME_ like concat('%',#{courseName},'%')
		    </if>
		</where>
  </select>
  
   <insert id="batchInsert" parameterType="java.util.List">
    insert into elc_affinity_courses_t(
    COURSE_CODE_
    )
    values
    <foreach item="item" collection="list" index="index"
             separator=",">
      (
      #{item.courseCode,jdbcType=VARCHAR}
      )
    </foreach>
  </insert>
</mapper>